<section class="vh-100">
  <div class="container py-5 h-100">
    <div class="row d-flex justify-content-center align-items-center h-100">
      <div class="col">
        <div class="card" id="list1" style="border-radius: .75rem; background-color: #eff1f2;">
          <div class="card-body py-4 px-4 px-md-5">
            <p class="h1 text-center mt-3 mb-4 pb-3 text-info">
              <i class="fas fa-check-square me-1"></i>
              <u>My Todo-s</u>
            </p>
            <div class="pb-2">
              <div class="card">
                <div class="card-body">
                  <div class="d-flex flex-row align-items-center">
                    <input type="text" class="form-control form-control-lg" id="exampleFormControlInput1"
                      placeholder="Search...">
                    <div>
                      <button type="button" class="ms-2 btn btn-info" data-bs-toggle="modal"
                        data-bs-target="#exampleModal">Add</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <hr class="my-4">
            <div class="d-flex justify-content-end align-items-center mb-4 pt-2 pb-3">
              <p class="small mb-0 me-2 text-muted">Filter</p>
              <select class="select">
                <option value="1">All</option>
                <option value="2">Completed</option>
                <option value="3">Active</option>
                <option value="4">Has due date</option>
              </select>
              <p class="small mb-0 ms-4 me-2 text-muted">Sort</p>
              <select class="select">
                <option value="1">Added date</option>
                <option value="2">Due date</option>
              </select>
              <a href="#!" style="color: #23af89;" data-mdb-toggle="tooltip" title="Ascending"><i
                  class="fas fa-sort-amount-down-alt ms-2"></i></a>
            </div>
            <div class="tab-content bg-transparent">
              <div id="note-full-container" class="note-has-grid row">
                <% if (notes.length && Array.isArray(notes)) { %>
                  <% notes.forEach(function(note) { %>
                    <div class="col-md-4 single-note-item all-category mb-3" style="">
                      <div class="card card-body">
                        <span class="side-stick"></span>
                        <h5 class="note-title text-truncate w-75 mb-0" data-noteheading="Book a Ticket for Movie">
                          <%= note.name %>

                        </h5>
                        <p class="note-date font-12 text-muted">
                          <%= moment(note.created_at) %>
                        </p>
                        <div class="note-content">
                          <p class="note-inner-content text-muted"
                            data-notecontent="Blandit tempus porttitor aasfs. Integer posuere erat a ante venenatis.">
                            <%= note.description %>
                          </p>
                        </div>
                        <div class="d-flex align-items-center">
                          <!-- <button class="mr-1"><i class="fa fa-edit edit-note" data-bs-toggle="modal"
                            data-bs-target="#updateModal"></i></button> -->
                          <button class="mr-1 edit-note" data-bs-toggle="modal" data-bs-target="#update-notes-modal"
                            data-noteid="<%= note.id %>"><i class="fa fa-edit"></i></button>
                          <button class="mr-1"><i class="fa fa-trash remove-note" data-bs-toggle="modal" data-bs-target="#delete-notes-modal"></i></button>
                          <div class="ml-auto">

                          </div>
                        </div>
                      </div>
                    </div>
                    <% }) %>
                      <% } else { %>
                        <p class="text-center">No notes available.</p>
                        <% } %>
              </div>
            </div>
          </div>
        </div>
      </div>
</section>
<!-- modal add -->
<section>
  <form method="post" action="/create-note" class="modal fade" id="exampleModal" tabindex="-1"
    aria-labelledby="exampleModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content border-0">
        <div class="modal-header bg-info text-white">
          <h5 class="modal-title text-white">Add Note</h5>
          <button type="button" class="close text-white" data-bs-dismiss="modal" aria-label="Close">
          </button>
        </div>
        <div class="modal-body">
          <div class="notes-box">
            <div class="notes-content">
              <form id="addnotesmodalTitle">
                <div class="row">
                  <div class="col-md-12 mb-3">
                    <div class="note-title">
                      <label>Note Title</label>
                      <input type="text" class="form-control" required placeholder="Title" name='name' />
                    </div>
                  </div>

                  <div class="col-md-12">
                    <div class="note-description">
                      <label>Note Description</label>
                      <textarea class="form-control" placeholder="Description" rows="3" name="description"
                        required></textarea>
                    </div>
                  </div>
                  <div class="col-md-12">
                    <div class="note-description">
                      <label>Note Description</label>
                      <input class="form-control" placeholder="Description" rows="3" type="file"
                        required></input>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-danger" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" id="btn-n-add" class="btn btn-info">Add</button>
        </div>
      </div>
    </div>
  </form>
</section>
<!-- modal update -->
<section>
  <form method="post" class="modal fade" id="update-notes-modal" tabindex="-1" aria-labelledby="updateleModalLabel"
    aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content border-0">
        <div class="modal-header bg-info text-white">
          <h5 class="modal-title text-white">Update Note</h5>
          <button type="button" class="close text-white" data-bs-dismiss="modal" aria-label="Close">

          </button>
        </div>
        <div class="modal-body">
          <div class="notes-box">
            <div class="notes-content">
              <div>
                <div class="row ">
                  <div class="col-md-12 mb-3 single-note-item">
                    <div>
                      <label>Note Title</label>
                      <input type="text" id="note-has-title" class="form-control" required placeholder="Tiêu đề"
                        name='nameNote' />
                    </div>
                  </div>

                  <div class="col-md-12 single-note-item">
                    <div class="note-description">
                      <label>Note Description</label>
                      <textarea id="note-has-description" class="form-control" placeholder="Mô tả" rows="3"
                        name="descriptionNote" required></textarea>
                    </div>
                  </div>
                </div>
                <input type="hidden" id="update-note-id" name="noteId">
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-danger" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-info">Update</button>
        </div>
      </div>
    </div>
  </form>
</section>
<!-- modal delete -->
<section>
  <form  class="modal fade" id="delete-notes-modal" tabindex="-1" aria-labelledby="deleteModalLabel"
    aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content border-0">
        <div class="modal-header bg-info text-white">
          <h5 class="modal-title text-white">Delete Note</h5>
          <button type="button" class="close text-white" data-bs-dismiss="modal" aria-label="Close">
          </button>
        </div>
        <div class="modal-body">
          <div class="notes-box">
            <div class="notes-content">
              <div>
               <div>_______________________</div>
                <input type="hidden" id="delete-note-id" name="noteId">
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-danger" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-info">Delete</button>
        </div>
      </div>
    </div>
  </form>
</section>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const editButtons = document.querySelectorAll('.edit-note');
    const updateForm = document.querySelector('#update-notes-modal');
    editButtons.forEach(button => {
      button.addEventListener('click', function () {
        const noteId = this.getAttribute('data-noteid');
        const formAction = `/update-note/${noteId}`;
        updateForm.setAttribute('action', formAction);
        const noteTitle = this.closest('.single-note-item').querySelector('.note-title').innerText;
        const noteDescription = this.closest('.single-note-item').querySelector('.note-inner-content').innerText;

        const updateNoteIdField = document.querySelector('#update-note-id');
        const noteTitleField = document.querySelector('#note-has-title');
        const noteDescriptionField = document.querySelector('#note-has-description');
        updateNoteIdField.value = noteId;
        noteTitleField.value = noteTitle;
        noteDescriptionField.value = noteDescription;
      });
    });
  });
</script>